# Bypass testing - switch between dev build and v1.0.1
# Usage:
#   Test dev build:  docker compose -f docker-compose.bypass-test.yml up shelfmark-dev
#   Test v1.0.1:     docker compose -f docker-compose.bypass-test.yml up shelfmark-stable
#   Pull latest dev: docker compose -f docker-compose.bypass-test.yml build shelfmark-dev
#   Pull v1.0.1:     docker compose -f docker-compose.bypass-test.yml pull shelfmark-stable

services:
  # Dev image from registry
  shelfmark-dev:
    image: ghcr.io/calibrain/shelfmark:dev
    container_name: shelfmark-bypass-dev
    environment:
      PUID: 1000
      PGID: 1000
      DEBUG: true
    ports:
      - 8084:8084
    volumes:
      - ./.local/bypass-test/config-dev:/config
      - ./.local/bypass-test/books:/books
      - ./.local/bypass-test/log-dev:/var/log/shelfmark
      - ./.local/bypass-test/tmp:/tmp/shelfmark

  # Stable v1.0.1 for comparison
  shelfmark-stable:
    image: ghcr.io/calibrain/shelfmark:1.0.1
    container_name: shelfmark-bypass-stable
    environment:
      PUID: 1000
      PGID: 1000
      DEBUG: true
    ports:
      - 8085:8084
    volumes:
      - ./.local/bypass-test/config-stable:/config
      - ./.local/bypass-test/books:/books
      - ./.local/bypass-test/log-stable:/var/log/shelfmark
      - ./.local/bypass-test/tmp:/tmp/shelfmark
